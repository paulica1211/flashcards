# éŸ³å£°éŒ²éŸ³ãƒ»å†ç”Ÿæ©Ÿèƒ½ã®æ¤œè¨

## ç›®çš„
å„ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ã«éŸ³å£°ã‚’éŒ²éŸ³ã—ã¦ã€å¾Œã‹ã‚‰èãç›´ã›ã‚‹æ©Ÿèƒ½

## UIè¨­è¨ˆæ¡ˆ

### 1. ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ç”»é¢ã«è¿½åŠ 
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Card 1 of 10          â”‚
â”‚  Importance: [0][1][2][3]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚
â”‚   ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ã®å†…å®¹  â”‚
â”‚                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ¤éŒ²éŸ³] [â–¶ï¸å†ç”Ÿ] [ğŸ—‘å‰Šé™¤] â”‚  â† æ–°è¦è¿½åŠ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Previous]    [Next]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹
- **éŒ²éŸ³ãƒœã‚¿ãƒ³**:
  - é€šå¸¸: ğŸ¤ ç°è‰²
  - éŒ²éŸ³ä¸­: ğŸ”´ èµ¤ï¼ˆéŒ²éŸ³æ™‚é–“ã‚’è¡¨ç¤ºï¼‰
  - éŒ²éŸ³æ¸ˆã¿: ğŸ¤ é’
- **å†ç”Ÿãƒœã‚¿ãƒ³**:
  - éŸ³å£°ãªã—: ç„¡åŠ¹åŒ–ï¼ˆç°è‰²ï¼‰
  - éŸ³å£°ã‚ã‚Š: â–¶ï¸ æœ‰åŠ¹
  - å†ç”Ÿä¸­: â¸ ä¸€æ™‚åœæ­¢ã‚¢ã‚¤ã‚³ãƒ³
- **å‰Šé™¤ãƒœã‚¿ãƒ³**:
  - éŸ³å£°ãªã—: éè¡¨ç¤º
  - éŸ³å£°ã‚ã‚Š: ğŸ—‘ è¡¨ç¤º

## ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æ–¹å¼

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³1: ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã¿ï¼ˆæ¨å¥¨ãƒ»ç°¡å˜ï¼‰
**ãƒ¡ãƒªãƒƒãƒˆ:**
- å®Ÿè£…ãŒç°¡å˜
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚³ã‚¹ãƒˆãªã—
- ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:**
- ãƒ‡ãƒã‚¤ã‚¹é–“ã§å…±æœ‰ã§ããªã„
- ã‚¢ãƒ—ãƒªå‰Šé™¤æ™‚ã«æ¶ˆãˆã‚‹

**å®Ÿè£…:**
```java
// ä¿å­˜å ´æ‰€
File audioDir = new File(getFilesDir(), "flashcard_audio");
File audioFile = new File(audioDir, "card_" + cardNumber + "_" + sheetName + ".3gp");

// MediaRecorderã§éŒ²éŸ³
MediaRecorder recorder = new MediaRecorder();
recorder.setAudioSource(MediaRecorder.AudioSource.MIC);
recorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
recorder.setOutputFile(audioFile.getAbsolutePath());

// MediaPlayerã§å†ç”Ÿ
MediaPlayer player = new MediaPlayer();
player.setDataSource(audioFile.getAbsolutePath());
player.prepare();
player.start();
```

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³2: Google Driveã«ä¿å­˜
**ãƒ¡ãƒªãƒƒãƒˆ:**
- ãƒ‡ãƒã‚¤ã‚¹é–“ã§å…±æœ‰å¯èƒ½
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è‡ªå‹•

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:**
- å®Ÿè£…ãŒè¤‡é›‘
- Google Drive APIã®è¨­å®šãŒå¿…è¦
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ã®åˆ¶é™

**å®Ÿè£…:**
1. Google Drive APIèªè¨¼
2. ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ: `/FlashcardAudio/`
3. ãƒ•ã‚¡ã‚¤ãƒ«å: `{sheetName}_card_{cardNumber}.3gp`
4. ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³3: Google Sheetsã«base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰
**ãƒ¡ãƒªãƒƒãƒˆ:**
- æ—¢å­˜ã®Google Sheetsé€£æºã‚’åˆ©ç”¨
- ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹é€ 

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:**
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãããªã‚‹ï¼ˆbase64ã§ç´„33%å¢—åŠ ï¼‰
- Google Sheetsã®ã‚»ãƒ«ã‚µã‚¤ã‚ºåˆ¶é™ï¼ˆ50,000æ–‡å­—ï¼‰
- çŸ­ã„éŒ²éŸ³ã®ã¿å¯èƒ½ï¼ˆ10ç§’ç¨‹åº¦ï¼‰

## æ¨å¥¨å®Ÿè£…æ–¹å¼: ãƒ­ãƒ¼ã‚«ãƒ« + ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚¯ãƒ©ã‚¦ãƒ‰

### ãƒ•ã‚§ãƒ¼ã‚º1: ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã¿
```
å†…éƒ¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æ§‹é€ :
/data/data/com.flashcardapp/files/
  â””â”€â”€ audio/
      â”œâ”€â”€ Sheet1_card_1.3gp
      â”œâ”€â”€ Sheet1_card_2.3gp
      â””â”€â”€ Sheet2_card_1.3gp
```

### ãƒ•ã‚§ãƒ¼ã‚º2: Google DriveåŒæœŸï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- è¨­å®šã§ON/OFFå¯èƒ½
- WiFiæ¥ç¶šæ™‚ã®ã¿è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### SQLiteè¿½åŠ ãƒ†ãƒ¼ãƒ–ãƒ«
```sql
CREATE TABLE audio_recordings (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    sheet_name TEXT NOT NULL,
    card_number INTEGER NOT NULL,
    local_path TEXT,
    drive_file_id TEXT,
    duration_ms INTEGER,
    recorded_at TIMESTAMP,
    uploaded_at TIMESTAMP,
    UNIQUE(sheet_name, card_number)
);
```

## æŠ€è¡“ä»•æ§˜

### 1. éŸ³å£°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: 3GP (AMR-NB)
- **ç†ç”±**: Androidãƒã‚¤ãƒ†ã‚£ãƒ–ã‚µãƒãƒ¼ãƒˆã€å°ã‚µã‚¤ã‚º
- **ä»£æ›¿æ¡ˆ**: M4A (AAC) - é«˜éŸ³è³ªã ãŒã‚µã‚¤ã‚ºå¤§

### 2. éŒ²éŸ³æ™‚é–“åˆ¶é™
- **æœ€å¤§éŒ²éŸ³æ™‚é–“**: 30ç§’ï¼ˆè¨­å®šã§å¤‰æ›´å¯èƒ½ï¼‰
- **ç†ç”±**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’æŠ‘ãˆã‚‹

### 3. ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³
```xml
<!-- AndroidManifest.xml -->
<uses-permission android:name="android.permission.RECORD_AUDIO" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
```

## å®Ÿè£…ã®æµã‚Œ

### 1. UIè¿½åŠ 
```xml
<!-- activity_flashcard.xml -->
<LinearLayout
    android:id="@+id/audioControls"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:gravity="center"
    android:layout_above="@id/navigationButtons">

    <com.google.android.material.button.MaterialButton
        android:id="@+id/recordButton"
        android:text="ğŸ¤ éŒ²éŸ³"
        style="@style/Widget.MaterialComponents.Button.OutlinedButton" />

    <com.google.android.material.button.MaterialButton
        android:id="@+id/playButton"
        android:text="â–¶ï¸ å†ç”Ÿ"
        style="@style/Widget.MaterialComponents.Button.OutlinedButton" />

    <com.google.android.material.button.MaterialButton
        android:id="@+id/deleteAudioButton"
        android:text="ğŸ—‘"
        style="@style/Widget.MaterialComponents.Button.TextButton" />
</LinearLayout>
```

### 2. éŒ²éŸ³å‡¦ç†
```java
private MediaRecorder mediaRecorder;
private boolean isRecording = false;

private void startRecording() {
    // ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯
    if (ContextCompat.checkSelfPermission(this, Manifest.permission.RECORD_AUDIO)
            != PackageManager.PERMISSION_GRANTED) {
        ActivityCompat.requestPermissions(this,
            new String[]{Manifest.permission.RECORD_AUDIO},
            REQUEST_RECORD_AUDIO);
        return;
    }

    File audioFile = getAudioFile(currentCardNumber);

    mediaRecorder = new MediaRecorder();
    mediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
    mediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
    mediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
    mediaRecorder.setOutputFile(audioFile.getAbsolutePath());
    mediaRecorder.setMaxDuration(30000); // 30ç§’

    try {
        mediaRecorder.prepare();
        mediaRecorder.start();
        isRecording = true;
        updateRecordButton();
    } catch (IOException e) {
        Log.e(TAG, "Recording failed", e);
    }
}

private void stopRecording() {
    if (mediaRecorder != null && isRecording) {
        mediaRecorder.stop();
        mediaRecorder.release();
        mediaRecorder = null;
        isRecording = false;
        updateRecordButton();
        Toast.makeText(this, "éŒ²éŸ³å®Œäº†", Toast.LENGTH_SHORT).show();
    }
}
```

### 3. å†ç”Ÿå‡¦ç†
```java
private MediaPlayer mediaPlayer;
private boolean isPlaying = false;

private void playAudio() {
    File audioFile = getAudioFile(currentCardNumber);

    if (!audioFile.exists()) {
        Toast.makeText(this, "éŒ²éŸ³ãŒã‚ã‚Šã¾ã›ã‚“", Toast.LENGTH_SHORT).show();
        return;
    }

    if (isPlaying) {
        stopAudio();
        return;
    }

    mediaPlayer = new MediaPlayer();
    try {
        mediaPlayer.setDataSource(audioFile.getAbsolutePath());
        mediaPlayer.prepare();
        mediaPlayer.start();
        isPlaying = true;
        updatePlayButton();

        mediaPlayer.setOnCompletionListener(mp -> {
            isPlaying = false;
            updatePlayButton();
        });
    } catch (IOException e) {
        Log.e(TAG, "Playback failed", e);
    }
}

private void stopAudio() {
    if (mediaPlayer != null && isPlaying) {
        mediaPlayer.stop();
        mediaPlayer.release();
        mediaPlayer = null;
        isPlaying = false;
        updatePlayButton();
    }
}
```

### 4. ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†
```java
private File getAudioFile(int cardNumber) {
    SharedPreferences preferences = getSharedPreferences(PREFS_NAME, MODE_PRIVATE);
    String sheetName = preferences.getString(KEY_SHEET_NAME, "Sheet1");

    File audioDir = new File(getFilesDir(), "audio");
    if (!audioDir.exists()) {
        audioDir.mkdirs();
    }

    String fileName = sheetName + "_card_" + cardNumber + ".3gp";
    return new File(audioDir, fileName);
}

private void deleteAudio() {
    File audioFile = getAudioFile(currentCardNumber);
    if (audioFile.exists()) {
        audioFile.delete();
        Toast.makeText(this, "å‰Šé™¤ã—ã¾ã—ãŸ", Toast.LENGTH_SHORT).show();
        updateAudioButtons();
    }
}
```

## æ³¨æ„ç‚¹ã¨èª²é¡Œ

### 1. ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- Android 6.0ä»¥é™ã¯ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ãŒå¿…è¦
- éŒ²éŸ³ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸæ™‚ã«è¨±å¯ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆ

### 2. ãƒ¡ãƒ¢ãƒªç®¡ç†
- MediaRecorder/MediaPlayerã®ãƒªãƒªãƒ¼ã‚¹ã‚’ç¢ºå®Ÿã«è¡Œã†
- Activityç ´æ£„æ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

### 3. ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
```java
@Override
protected void onPause() {
    super.onPause();
    if (isRecording) {
        stopRecording();
    }
    if (isPlaying) {
        stopAudio();
    }
}

@Override
protected void onDestroy() {
    super.onDestroy();
    if (mediaRecorder != null) {
        mediaRecorder.release();
        mediaRecorder = null;
    }
    if (mediaPlayer != null) {
        mediaPlayer.release();
        mediaPlayer = null;
    }
}
```

### 4. ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡
- 3GPå½¢å¼: ç´„1KB/ç§’
- 30ç§’éŒ²éŸ³ Ã— 100ã‚«ãƒ¼ãƒ‰ = ç´„3MB
- å®¹é‡ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½ã®è¿½åŠ ã‚’æ¨å¥¨

### 5. ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å†ç”Ÿ
- ã‚«ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆãŸã‚‰è‡ªå‹•åœæ­¢
- ã¾ãŸã¯å†ç”Ÿä¸­ã¯åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–

## å°†æ¥ã®æ‹¡å¼µæ¡ˆ

### 1. éŸ³å£°ã®è¦–è¦šåŒ–
- éŒ²éŸ³ä¸­ã®æ³¢å½¢è¡¨ç¤º
- å†ç”Ÿä¸­ã®é€²æ—ãƒãƒ¼

### 2. é€Ÿåº¦èª¿æ•´
```java
mediaPlayer.setPlaybackParams(
    mediaPlayer.getPlaybackParams().setSpeed(1.5f)
);
```

### 3. è‡ªå‹•å†ç”Ÿè¨­å®š
- ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºæ™‚ã«è‡ªå‹•å†ç”Ÿ
- è¨­å®šã§ON/OFF

### 4. éŸ³å£°ãƒ¡ãƒ¢æ©Ÿèƒ½
- è¡¨é¢ç”¨ã¨è£é¢ç”¨ã§åˆ¥ã€…ã«éŒ²éŸ³
- é•·ã‚ã®èª¬æ˜éŸ³å£°ã‚‚ä¿å­˜

### 5. ã‚¯ãƒ©ã‚¦ãƒ‰åŒæœŸ
- Google Drive APIé€£æº
- Dropboxé€£æº
- ç‹¬è‡ªã‚µãƒ¼ãƒãƒ¼

## å®Ÿè£…ã®å„ªå…ˆé †ä½

### Phase 1ï¼ˆåŸºæœ¬æ©Ÿèƒ½ï¼‰
1. ãƒ­ãƒ¼ã‚«ãƒ«éŒ²éŸ³ãƒ»å†ç”Ÿ
2. å‰Šé™¤æ©Ÿèƒ½
3. UIè¿½åŠ 

### Phase 2ï¼ˆæ”¹å–„ï¼‰
1. éŒ²éŸ³æ™‚é–“è¡¨ç¤º
2. å†ç”Ÿé€²æ—ãƒãƒ¼
3. éŸ³å£°å“è³ªè¨­å®š

### Phase 3ï¼ˆã‚¯ãƒ©ã‚¦ãƒ‰ï¼‰
1. Google DriveåŒæœŸ
2. è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
3. è¤‡æ•°ãƒ‡ãƒã‚¤ã‚¹å¯¾å¿œ

## è¦‹ç©ã‚‚ã‚Š

**å®Ÿè£…æ™‚é–“:**
- Phase 1: 4-6æ™‚é–“
- Phase 2: 2-3æ™‚é–“
- Phase 3: 8-10æ™‚é–“

**ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºå½±éŸ¿:**
- 100ã‚«ãƒ¼ãƒ‰ Ã— 30ç§’éŒ²éŸ³ = ç´„3MB
- APKã‚µã‚¤ã‚º: ã»ã¼å¤‰åŒ–ãªã—ï¼ˆæ—¢å­˜APIã®ã¿ä½¿ç”¨ï¼‰
