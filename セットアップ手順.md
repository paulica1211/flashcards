# フラッシュカードアプリ - セットアップ手順書

このアプリを使用するには、自分のGoogle Sheetsにフラッシュカードデータを作成し、アプリと紐づける必要があります。

## 📋 目次

1. [Google Sheetsの準備](#1-google-sheetsの準備)
2. [Google Apps Scriptの設定](#2-google-apps-scriptの設定)
3. [ウェブアプリのデプロイ](#3-ウェブアプリのデプロイ)
4. [アプリへの接続](#4-アプリへの接続)
5. [動作確認](#5-動作確認)

---

## 1. Google Sheetsの準備

### ステップ1-1: 新しいスプレッドシートを作成

1. [Google Sheets](https://sheets.google.com)を開く
2. **「新しいスプレッドシート」** をクリック
3. ファイル名を変更（例：「英単語フラッシュカード」）

### ステップ1-2: データ形式を設定

スプレッドシートを以下の形式で作成します：

| A列（表面） | B列（裏面） | C列（重要度） |
|------------|-----------|------------|
| Question | Answer | Importance |
| What is 2+2? | 4 | 1 |
| Capital of France? | Paris | 2 |
| Largest planet? | Jupiter | 3 |

**重要なポイント：**
- **1行目**: ヘッダー（任意のテキスト）
- **2行目以降**: フラッシュカードのデータ
- **A列**: カードの表面（問題）
- **B列**: カードの裏面（答え）
- **C列**: 重要度レベル（0～3の数字）
  - `0` = 低優先度
  - `1` = 通常
  - `2` = 重要
  - `3` = 最重要

### ステップ1-3: テキスト装飾（オプション）

Google Sheetsで以下の装飾が使用できます：

- **太字**: テキストを選択 → `Ctrl+B` (Win) / `Cmd+B` (Mac)
- *斜体*: テキストを選択 → `Ctrl+I` / `Cmd+I`
- <u>下線</u>: テキストを選択 → `Ctrl+U` / `Cmd+U`
- ~~取り消し線~~: テキストを選択 → `Alt+Shift+5`
- **色**: テキストを選択 → ツールバーの「テキストの色」

**例：**
```
A2: What is H₂O?
B2: Water (太字で「Water」を装飾)
C2: 1
```

---

## 2. Google Apps Scriptの設定

### ステップ2-1: Apps Scriptエディタを開く

1. Google Sheetsのメニューバーで **「拡張機能」** をクリック
2. **「Apps Script」** を選択
3. 新しいタブでスクリプトエディタが開きます

### ステップ2-2: スクリプトをコピー＆ペースト

1. エディタに表示されているデフォルトのコード（`function myFunction() {}`）を **すべて削除**
2. 以下のフォルダからスクリプトをコピー：
   ```
   flashcard/google-apps-script/Code.gs
   ```
3. エディタに **ペースト**
4. **保存アイコン（💾）** をクリック、またはショートカット `Ctrl+S` / `Cmd+S`
5. プロジェクト名を入力（例：「Flashcard API」）→ **OK**

**スクリプトの場所:**
- リポジトリ: `google-apps-script/Code.gs`
- または、このドキュメントの末尾に全コードを掲載

---

## 3. ウェブアプリのデプロイ

### ステップ3-1: デプロイを開始

1. スクリプトエディタの右上にある **「デプロイ」** ボタンをクリック
2. **「新しいデプロイ」** を選択

### ステップ3-2: デプロイ設定

1. **種類を選択** → **「ウェブアプリ」** を選択（歯車アイコンをクリック）

2. 以下の設定を行う：

   | 項目 | 設定値 |
   |-----|-------|
   | **説明** | 「Flashcard API v1」（任意） |
   | **実行ユーザー** | **「自分」** を選択 |
   | **アクセスできるユーザー** | **「全員」** を選択 |

   **重要:**
   - 「実行ユーザー」は **必ず「自分」** を選択
   - 「アクセスできるユーザー」は **「全員」** を選択（Googleアカウントでのログイン不要）

3. **「デプロイ」** ボタンをクリック

### ステップ3-3: 権限の承認

初回デプロイ時に権限の承認が必要です：

1. **「アクセスを承認」** をクリック
2. 自分のGoogleアカウントを選択
3. **「詳細」** をクリック（「このアプリは確認されていません」という警告が表示された場合）
4. **「（プロジェクト名）に移動」** をクリック
5. **「許可」** をクリック

### ステップ3-4: ウェブアプリURLを取得

1. デプロイが完了すると、**「ウェブアプリ」** のURLが表示されます
2. URLは以下のような形式です：
   ```
   https://script.google.com/macros/s/AKfycbxXXXXXXXXXXXXXXXXXXX/exec
   ```
3. **「URLをコピー」** をクリック、または手動でコピー
4. このURLを **安全な場所に保存**（次のステップで使用します）

**⚠️ 重要:** このURLは公開されても問題ありませんが、誰でもあなたのスプレッドシートのデータを読み取れるようになります。重要な情報を保存しないでください。

---

## 4. アプリへの接続

### ステップ4-1: アプリを起動

1. Androidデバイスで **Flashcard App** を起動
2. 初回起動時、または設定画面が表示されます

### ステップ4-2: API URLを設定

1. **「Settings」（⚙️）** ボタンをタップ
2. **「API URL」** フィールドに、先ほどコピーしたウェブアプリURLを **ペースト**
   ```
   https://script.google.com/macros/s/AKfycbxXXXXXXXXXXXXXXXXXXX/exec
   ```
3. **「Save」** または **「保存」** をタップ

### ステップ4-3: シートを選択

1. **「Select Sheet」** または **「シート選択」** をタップ
2. Google Sheetsのタブ名が表示されます（例：「Sheet1」「英単語」など）
3. 使用したいシートを選択
4. 設定画面を閉じる

---

## 5. 動作確認

### ステップ5-1: フラッシュカードを表示

1. メイン画面に戻ると、自動的に最初のフラッシュカードが表示されます
2. カードの表面（問題）が表示されていることを確認

### ステップ5-2: カードを反転

1. 画面を **左右にスワイプ** してカードを反転
2. カードの裏面（答え）が表示されることを確認

### ステップ5-3: ナビゲーション

- **次のカード**: 右矢印（→）ボタンをタップ、または右スワイプ
- **前のカード**: 左矢印（←）ボタンをタップ、または左スワイプ
- **特定のカードにジャンプ**: 設定画面から「Jump to Card」機能を使用

---

## 🎯 追加機能

### 音声録音機能

1. フラッシュカード画面で **マイクアイコン（🎤）** をタップ
2. 最大60秒間の音声メモを録音
3. **再生ボタン（▶️）** で録音を再生
4. 録音ファイルは自動的に `Music/FlashcardApp/{シート名}/` に保存されます

### 複数のフラッシュカードセット

1. Google Sheetsで複数のタブ（シート）を作成
2. 各タブに異なるフラッシュカードセットを作成
3. アプリの設定画面でシートを切り替え

### 進捗管理

- アプリは各シートごとに現在のカード番号を自動的に記憶
- Google Sheetsに「Settings」という名前のシートが自動的に作成され、進捗が保存されます

---

## ❗ トラブルシューティング

### カードが表示されない

**原因と解決方法:**
1. **インターネット接続を確認**
   - Wi-Fiまたはモバイルデータが有効か確認
2. **API URLが正しいか確認**
   - 設定画面でURLを再確認
   - URLが完全にコピーされているか確認（最後の `/exec` まで）
3. **Google Sheetsのデータ形式を確認**
   - A列にデータが入力されているか
   - 2行目以降にデータがあるか
4. **Google Apps Scriptのデプロイ設定を確認**
   - 「アクセスできるユーザー」が「全員」になっているか

### 「Sheet not found」エラー

**原因:**
- 選択したシート名がGoogle Sheetsに存在しない

**解決方法:**
1. Google Sheetsでシート名を確認
2. アプリで正しいシート名を選択

### 装飾が表示されない

**原因:**
- Google Sheetsで装飾が正しく適用されていない

**解決方法:**
1. Google Sheetsでテキストを選択
2. ツールバーから装飾を再適用
3. アプリを再読み込み（カードを切り替える）

### 音声が録音できない

**原因:**
- マイク権限が許可されていない

**解決方法:**
1. Android設定 → アプリ → Flashcard App → 権限
2. 「マイクロフォン」権限を **許可**

---

## 📱 必要な権限

アプリは以下の権限を要求します：

| 権限 | 目的 |
|-----|-----|
| **インターネット** | Google Sheetsからデータを取得 |
| **マイクロフォン** | 音声メモの録音 |
| **ストレージ** | 音声ファイルをMusicフォルダに保存 |

---

## 🔄 データの更新方法

Google Sheetsでフラッシュカードを追加・編集した場合：

1. Google Sheetsでデータを編集・追加
2. アプリで自動的に最新データが反映されます
3. 反映されない場合は、アプリを再起動

---

## 📝 Google Apps Script コード

以下のコードを `Code.gs` にコピーしてください：

```javascript
// flashcard/google-apps-script/Code.gs の内容をここにコピー
// 上記のステップ2-2で使用するコード
```

**コードの取得方法:**
1. プロジェクトフォルダの `google-apps-script/Code.gs` を開く
2. すべてのコードをコピー
3. Google Apps Scriptエディタにペースト

---

## ✅ セットアップ完了

これでフラッシュカードアプリの準備が完了しました！

**次のステップ:**
- フラッシュカードを追加する
- 音声メモを録音する
- 複数のフラッシュカードセットを作成する
- 友人とGoogle Sheetsを共有して一緒に学習する

**質問がある場合:**
- GitHub Issues: https://github.com/paulica1211/flashcards/issues
- README.mdで機能の詳細を確認

---

## 🔐 セキュリティとプライバシー

- **データの保存場所**: すべてのデータは自分のGoogle Sheetsに保存されます
- **アクセス権限**: ウェブアプリのURLを知っている人は誰でもデータを読み取れます
- **推奨事項**:
  - 個人情報や機密情報をフラッシュカードに保存しない
  - URLを信頼できる人とのみ共有
  - Google Sheetsの共有設定で閲覧権限を管理

---

**バージョン:** 1.0
**最終更新:** 2025年
**サポート:** Android 8.0 (API 26) 以上
